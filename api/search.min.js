/* Postcodify, LGPL v3, see https://github.com/kijin/postcodify */
(function($){if("undefined"==typeof $.fn.postcodify){var e={version:"2.0.0",location:""};$("script").each(function(){var a=$(this).attr("src");if(a){var s=a.match(/^(https?:)?\/\/([^:\/]+)(?=[:\/]).*\/search\.(min\.)?js(?=\?|$)/);s&&(e.location=s[2])}}),$.fn.postcodify=function(a){return this.each(function(){var s=$.extend({api:e.freeAPI.defaultUrl,apiBackup:null,timeout:3e3,timeoutBackup:8e3,callBackupFirst:!1,controls:this,results:this,language:"ko",autoSelect:!1,searchButtonContent:null,mapLinkProvider:!1,mapLinkContent:null,insertDbid:null,insertPostcode5:null,insertPostcode6:null,insertAddress:null,insertJibeonAddress:null,insertEnglishAddress:null,insertEnglishJibeonAddress:null,insertDetails:null,insertExtraInfo:null,beforeSearch:function(){},afterSearch:function(){},beforeSelect:function(){},afterSelect:function(){},onReady:function(){},onSuccess:function(){},onBackup:function(){},onError:function(){},onComplete:function(){},focusKeyword:!0,focusDetails:!0,hideOldAddresses:!0,hideSummary:!1,useFullJibeon:!1,useAlert:!1},a);s.language=s.language.toLowerCase(),s.api===e.freeAPI.defaultUrl&&null===s.apiBackup&&(s.apiBackup=e.freeAPI.backupUrl),null===s.searchButtonContent&&(s.searchButtonContent=e.translations[s.language].msgSearch);var r=$(s.results),o=$("<div></div>").postcodifyAddClass("search_controls"),i="postcodify_"+(new Date).getTime().toString()+Math.random().toString().substr(2,4),d=($("<label></label>").attr("for",i).text(e.translations[s.language].msgKeywords).hide().appendTo(o),$('<input type="text" class="keyword" value="" />').attr("id",i).appendTo(o)),t=$('<button type="button" class="search_button"></button>').attr("id",i+"_button").html(s.searchButtonContent).appendTo(o);o.prependTo(s.controls);var n="";return d.keypress(function(e){13==e.which&&(e.preventDefault(),t.trigger("click"))}),t.focusin(function(){t.trigger("click")}),t.click(function(A){A.preventDefault();var a=$.trim(d.val());if(a!==n){if(n=a,r.find("div.postcodify_search_result,div.postcodify_search_status").remove(),a.length<3)return void(s.useAlert?alert(e.translations[s.language].errorTooShort):$('<div class="too_short"></div>').postcodifyAddClass("search_status").html(e.translations[s.language].errorTooShort.replace(/\n/g,"<br>")).appendTo(r));if(s.beforeSearch(a)!==!1){var h=$(window).scrollTop();t.attr("disabled","disabled");var i;navigator.userAgent&&navigator.userAgent.match(/MSIE [5-8]\./)?(t.text("."),i=setInterval(function(){switch(t.text()){case".":t.text("..");break;case"..":t.text("...");break;case"...":t.text("....");break;case"....":t.text(".")}},160)):(t.html('<img class="searching" alt="'+e.translations[s.language].msgSearch+'" src="'+e.searchProgress+'" />'),i=!1);var c,p,u,o,l=function(o,n,d){c=(new Date).getTime(),s.currentRequestUrl=o;var r={url:o,data:{v:e.version,q:a,ref:window.location.hostname,cdn:e.location},processData:!0,cache:!1,timeout:n,success:p,error:d,complete:function(){$(window).scrollTop(h),i!==!1&&clearTimeout(i),t.removeAttr("disabled").html(s.searchButtonContent)}};"withCredentials"in new XMLHttpRequest||"undefined"!=typeof XDomainRequest?r.dataType="json":(r.dataType="jsonp",r.jsonpCallback="postcodify_"+c.toString()+Math.random().toString().substr(2,4)),$.ajax(r)};p=function(i){var w=((new Date).getTime()-c)/1e3;if(s.currentRequestUrl===s.apiBackup&&(s.callBackupFirst=!0),s.afterSearch(a,i.results,i.lang,i.sort)!==!1){if(i.error&&i.error.toLowerCase().indexOf("database")>-1)s.currentRequestUrl===s.api&&s.apiBackup&&s.api!==s.apiBackup&&(s.onBackup(),l(s.apiBackup,s.timeoutBackup,o));else if(i.error&&i.error.toLowerCase().indexOf("quota")>-1)if(s.useAlert)alert(e.translations[s.language].errorQuota);else{var p=$('<div class="quota"></div>').postcodifyAddClass("search_status");p.html(e.translations[s.language].errorQuota.replace(/\n/g,"<br>")),p.appendTo(r)}else if(i.error){if(s.useAlert)alert(e.translations[s.language].errorError);else{var p=$('<div class="error"></div>').postcodifyAddClass("search_status");p.html(e.translations[s.language].errorError.replace(/\n/g,"<br>")),p.appendTo(r)}n=""}else if(0==i.count)if(s.useAlert)alert(e.translations[s.language].errorEmpty);else{var p=$('<div class="empty"></div>').postcodifyAddClass("search_status");p.html(e.translations[s.language].errorEmpty.replace(/\n/g,"<br>")),p.appendTo(r)}else if("undefined"==typeof i.results[0].other)if(s.useAlert)alert(e.translations[s.language].errorVersion);else{var p=$('<div class="error"></div>').postcodifyAddClass("search_status");p.html(e.translations[s.language].errorVersion.replace(/\n/g,"<br>")),p.appendTo(r)}else{var u;u="undefined"!=typeof i.lang&&"EN"===i.lang?"en":"ko";for(var m=0;m<i.count;m++){var t=i.results[m],d=$("<div></div>").postcodifyAddClass("search_result");d.data("dbid",t.dbid),d.data("code6",t.code6),d.data("code5",t.code5),d.data("address",t.address.base+" "+t.address["new"]),d.data("jibeon_address",t.address.base+" "+t.address.old),d.data("english_address",(""===t.english["new"]?"":t.english["new"]+", ")+t.english.base),d.data("english_jibeon_address",(""===t.english.old?"":t.english.old+", ")+t.english.base),d.data("extra_info_long",t.other["long"]),d.data("extra_info_short",t.other["short"]),d.data("extra_info_nums",i.nums);var f,A;"en"===u?"undefined"!=typeof i.sort&&"JIBEON"===i.sort?(f=d.data("english_jibeon_address"),A=t.english["new"]):(f=d.data("english_address"),A=t.english.old):"undefined"!=typeof i.sort&&"JIBEON"===i.sort?(f=t.address.base+" "+t.address.old,A=t.address["new"]):(f=t.address.base+" "+t.address["new"],A=t.other["long"]);var v=$('<a class="selector" href="#"></a>');if(v.append($('<span class="address_info"></span>').text(f)),null!==A&&""!==A&&v.append($('<span class="extra_info"></span>').append("("+A+")")),$('<div class="code6"></div>').text(t.code6).appendTo(d),$('<div class="code5"></div>').text(t.code5).appendTo(d),$('<div class="address"></div>').append(v).appendTo(d),"undefined"!=typeof i.lang&&"EN"===i.lang&&(t.other.others=t.other.others.replace(/\uc0b0([0-9]+)/g,"San $1"),t.other.others=$.trim(t.other.others.replace(/[^0-9a-zA-Z\x20.,-]/g,"").replace(/\s+/g," "))),""!==t.other.others){var k=$('<a href="#" class="show_old_addresses">\u25bc</a>');k.attr("title",e.translations[u].msgShowOthers),k.appendTo(d.find("div.address"));var y=$('<div class="old_addresses"></div>').text(t.other.others);s.hideOldAddresses&&y.css("display","none"),y.appendTo(d)}if(s.mapLinkProvider){var h;h="undefined"!=typeof e.mapProviders[s.mapLinkProvider]?e.mapProviders[s.mapLinkProvider]:s.mapLinkProvider,h=h.replace("$JUSO",encodeURIComponent(t.address.base+" "+t.address["new"]).replace(/%20/g,"+")),h=h.replace("$JIBEON",encodeURIComponent(t.address.base+" "+t.address.old).replace(/%20/g,"+"));var b=null!==s.mapLinkContent?s.mapLinkContent:e.translations[u].msgMap,_=$('<a target="_blank"></a>').attr("href",h).html(b);$('<div class="map_link"></div>').append(_).appendTo(d)}d.appendTo(r)}if(!s.hideSummary){var g=$('<div class="summary"></div>').postcodifyAddClass("search_status");g.append('<div class="result_count">'+e.translations[u].msgResultCount+": <span>"+i.count+"</span></div>"),g.append('<div class="search_time">'+e.translations[u].msgSearchTime+": <span>"+Math.round(1e3*i.time)+"ms</span></div>"),g.append('<div class="network_time">'+e.translations[u].msgNetworkTime+": <span>"+Math.round(1e3*(w-parseFloat(i.time)))+"ms</span></div>"),g.appendTo(r)}if(i.count>=100)if(s.useAlert)alert(e.translations[u].errorTooMany);else{var p=$('<div class="too_many"></div>').postcodifyAddClass("search_status");p.html(e.translations[u].errorTooMany.replace(/\n/g,"<br>")),p.insertBefore(r.find("div.postcodify_search_result").first())}}s.onSuccess(),s.onComplete(),!i.error&&1==i.count&&i.nums&&s.autoSelect&&r.find("div.postcodify_search_result a.selector").first().trigger("click")}},u=function(e,a,r){s.apiBackup?(s.onBackup(),l(s.apiBackup,s.timeoutBackup,o)):o(e,a,r)},o=function(){r.find("div.postcodify_search_status.error").show(),n="",s.onError(),s.onComplete()},s.apiBackup&&s.callBackupFirst?l(s.apiBackup,s.timeoutBackup,o):l(s.api,s.timeout,u)}}}),r.on("click","div.code6,div.code5,div.old_addresses",function(e){e.preventDefault(),e.stopPropagation(),$(this).parent().find("a.selector").click()}),r.on("click","a.selector",function(l){l.preventDefault();var e=$(this).parents("div.postcodify_search_result");if(s.beforeSelect(e)!==!1){var o=e.data("address"),n=e.data("jibeon_address"),i=e.data("english_address"),d=e.data("english_jibeon_address");if(e.data("extra_info_nums")){var r=e.data("extra_info_nums"),t=/[0-9]+(-[0-9]+)? ~ [0-9]+(-[0-9]+)?/;o=o.replace(t,r),n=n.replace(t,r),i=i.replace(t,r),d=d.replace(t,r)}if(s.insertDbid&&$(s.insertDbid).val(e.data("dbid")),s.insertPostcode6&&$(s.insertPostcode6).val(e.data("code6")),s.insertPostcode5&&$(s.insertPostcode5).val(e.data("code5")),s.insertAddress&&$(s.insertAddress).val(o),s.insertJibeonAddress&&$(s.insertJibeonAddress).val(n),s.insertEnglishAddress&&$(s.insertEnglishAddress).val(i),s.insertEnglishJibeonAddress&&$(s.insertEnglishJibeonAddress).val(d),s.insertExtraInfo){var a=e.data(s.useFullJibeon?"extra_info_long":"extra_info_short");a.length&&(a="("+a+")"),$(s.insertExtraInfo).val(s.insertExtraInfo===s.insertAddress?$(s.insertExtraInfo).val()+"\n"+a:a)}s.afterSelect(e)!==!1&&s.insertDetails&&s.focusDetails&&$(s.insertDetails).focus()}}),r.on("click","a.show_old_addresses",function(a){a.preventDefault();var e=$(this).parent().siblings(".old_addresses");e.is(":visible")?($(this).html("&#9660;"),e.hide()):($(this).html("&#9650;"),e.show())}),s.focusKeyword&&d.focus(),s.onReady(),this})},$.fn.postcodifyAddClass=function(e){return this.addClass("postcodify_"+e).addClass("postcode_"+e)},e.freeAPI={defaultUrl:"//api.poesis.kr/post/search.php",backupUrl:"//backup.api.poesis.kr/post/search.php"},e.mapProviders={daum:"http://map.daum.net/?map_type=TYPE_MAP&urlLevel=3&q=$JUSO",naver:"http://map.naver.com/?mapMode=0&dlevel=12&query=$JUSO",google:"http://www.google.com/maps/place/"+encodeURIComponent("\ub300\ud55c\ubbfc\uad6d")+"+$JUSO"},e.translations={ko:{errorError:"\uac80\uc0c9 \uc11c\ubc84\uc640 \ud1b5\uc2e0 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\uc600\uc2b5\ub2c8\ub2e4.\n\uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.",errorEmpty:"\uac80\uc0c9 \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\n\uc815\ud655\ud55c \ub3c4\ub85c\uba85\uacfc \uac74\ubb3c\ubc88\ud638 \ub610\ub294 \ub3d9\xb7\ub9ac\uc640 \ubc88\uc9c0\ub85c \uac80\uc0c9\ud574 \uc8fc\uc2dc\uace0,\n\ub2e4\ub978 \uac80\uc0c9\uc5b4 \uc0ac\uc6a9\uc2dc \ub744\uc5b4\uc4f0\uae30\uc5d0 \uc720\uc758\ud558\uc2ed\uc2dc\uc624.",errorQuota:"\uc77c\uc77c \ud5c8\uc6a9 \ucffc\ub9ac\uc218\ub97c \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4.\n\uad00\ub9ac\uc790\uc5d0\uac8c \ubb38\uc758\ud574 \uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.",errorVersion:"\uac80\uc0c9 \uc11c\ubc84\uc758 \ubc84\uc804\uc774 \ub0ae\uc544 \uc774 \uac80\uc0c9\ucc3d\uacfc \ud638\ud658\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.",errorTooShort:"\uac80\uc0c9\uc5b4\ub294 3\uae00\uc790 \uc774\uc0c1 \uc785\ub825\ud574 \uc8fc\uc2ed\uc2dc\uc624.",errorTooMany:"\uac80\uc0c9 \uacb0\uacfc\uac00 \ub108\ubb34 \ub9ce\uc544 100\uac74\ub9cc \ud45c\uc2dc\ud569\ub2c8\ub2e4.\n\uc815\ud655\ud55c \ub3c4\ub85c\uba85\uacfc \uac74\ubb3c\ubc88\ud638 \ub610\ub294 \ub3d9\xb7\ub9ac\uc640 \ubc88\uc9c0\ub85c \uac80\uc0c9\ud574 \uc8fc\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.",msgResultCount:"\uac80\uc0c9 \uacb0\uacfc",msgSearchTime:"\uc18c\uc694 \uc2dc\uac04",msgNetworkTime:"\ud1b5\uc2e0 \uc9c0\uc5f0",msgSeeOthers:"\uad00\ub828\uc9c0\ubc88 \ubcf4\uae30",msgKeywords:"\uac80\uc0c9 \ud0a4\uc6cc\ub4dc",msgSearch:"\uac80\uc0c9",msgMap:"\uc9c0\ub3c4"},en:{errorError:"An error occurred while communicating to the search server.\nPlease try again later.",errorEmpty:"No addresses matched your search.\nPlease enter the exact legal name of your street, as well as the number(s).",errorQuota:"This website and/or your IP address has exceeded its daily search quota.\nPlease contact the administrator.",errorVersion:"The version of the search server is not compatible with this search function.",errorTooShort:"Please enter at least 3 characters.",errorTooMany:"Your search returned too many results. Only the first 100 items are shown below.\nPlease narrow down your search by adding the number(s).",msgResultCount:"Results",msgSearchTime:"Time taken",msgNetworkTime:"Network delay",msgSeeOthers:"See related addresses",msgKeywords:"Search keywords",msgSearch:"Search",msgMap:"Map"}},e.searchProgress="data:image/gif;base64,R0lGODlhEAALAPQAAP///yIiIt7e3tbW1uzs7CcnJyIiIklJSZKSknV1dcPDwz8/P2JiYpmZmXh4eMbGxkJCQiUlJWVlZenp6d3d3fX19VJSUuDg4PPz87+/v6ysrNDQ0PDw8AAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCwAAACwAAAAAEAALAAAFLSAgjmRpnqSgCuLKAq5AEIM4zDVw03ve27ifDgfkEYe04kDIDC5zrtYKRa2WQgAh+QQJCwAAACwAAAAAEAALAAAFJGBhGAVgnqhpHIeRvsDawqns0qeN5+y967tYLyicBYE7EYkYAgAh+QQJCwAAACwAAAAAEAALAAAFNiAgjothLOOIJAkiGgxjpGKiKMkbz7SN6zIawJcDwIK9W/HISxGBzdHTuBNOmcJVCyoUlk7CEAAh+QQJCwAAACwAAAAAEAALAAAFNSAgjqQIRRFUAo3jNGIkSdHqPI8Tz3V55zuaDacDyIQ+YrBH+hWPzJFzOQQaeavWi7oqnVIhACH5BAkLAAAALAAAAAAQAAsAAAUyICCOZGme1rJY5kRRk7hI0mJSVUXJtF3iOl7tltsBZsNfUegjAY3I5sgFY55KqdX1GgIAIfkECQsAAAAsAAAAABAACwAABTcgII5kaZ4kcV2EqLJipmnZhWGXaOOitm2aXQ4g7P2Ct2ER4AMul00kj5g0Al8tADY2y6C+4FIIACH5BAkLAAAALAAAAAAQAAsAAAUvICCOZGme5ERRk6iy7qpyHCVStA3gNa/7txxwlwv2isSacYUc+l4tADQGQ1mvpBAAIfkECQsAAAAsAAAAABAACwAABS8gII5kaZ7kRFGTqLLuqnIcJVK0DeA1r/u3HHCXC/aKxJpxhRz6Xi0ANAZDWa+kEAA7AAAAAAAAAAAA"}})(jQuery);